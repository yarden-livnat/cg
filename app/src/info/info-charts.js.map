{"version":3,"sources":["info-charts.es6"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;mBAae,UAAS,GAAG,EAAE;AAC3B,QAAM,KAAK,GAAG,CAAC,CAAC;AAChB,QAAM,eAAe,GAAG,GAAG,CAAC;;AAE5B,QAAI,UAAU,GAAG,gBAAG,IAAI,CAAC,MAAM,CAAC,UAAU,CAAC,CAAC;;AAE5C,QAAI,UAAS,YAAA,CAAC;AACd,QAAI,WAAW,GAAG,EAAE,CAAC;AACrB,QAAI,YAAY,GAAG,wBAAO,gBAAgB,EAAE,IAAI,CAAC,CAAC;;;AAGlD,QAAI,mBAAmB,GAAG,gBAAG,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,CAC7C,CAAC,OAAO,EAAE,UAAS,CAAC,EAAE;AAAE,aAAO,CAAC,CAAC,OAAO,EAAE,IAAI,CAAC,CAAC;KAAE,CAAC,EACnD,CAAC,IAAI,EAAE,UAAS,CAAC,EAAE;AAAE,aAAO,CAAC,CAAC,QAAQ,EAAE,CAAC;KAAE,CAAC,CAC7C,CAAC,CAAC;;AAEH,QAAI,eAAe,GAAG,gBAAG,IAAI,CAAC,KAAK,EAAE,CAClC,IAAI,CAAC,gBAAG,IAAI,CAAC,IAAI,EAAE,CAAC,CAAC,CAAC;AACzB,mBAAe,CAAC,UAAU,CAAC,gBAAG,MAAM,CAAC,OAAO,CAAC,CAAC,CAAC;AAC/C,mBAAe,CAAC,KAAK,CAAC,gBAAG,IAAI,CAAC,IAAI,EAAE,CAAC,CAAC,CAAC;;AAEvC,QAAI,MAAM,GAAG,IAAI,GAAG,CAAC,CACnB,CAAC,gBAAgB,EAAE,YAAY,CAAC,CAEjC,CAAC,CAAC;;AAEH,QAAI,SAAS,GAAG,IAAI,GAAG,EAAE,CAAC;;AAE1B,QAAI,SAAS,GAAG,EAAE,CAAC;;AAEnB,aAAS,KAAI,GAAG;AACd,0BAAO,SAAS,CAAC,EAAC,OAAO,EAAE,MAAM,EAAE,KAAK,EAAE,SAAS,EAAE,QAAQ,EAAE,WAAW,EAAC,CAAC,CAAC;;;AAG7E,UAAI,KAAK,GAAG,gBAAG,MAAM,CAAC,YAAY,CAAC,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC,SAAS,CAAC,IAAI,CAAC,CAC7D,IAAI,CAAC,MAAK,SAAS,CAAC,CACpB,KAAK,EAAE,CACP,MAAM,CAAC,IAAI,CAAC,CAAC;;AAEhB,WAAK,CAAC,MAAM,CAAC,OAAO,CAAC,CAClB,IAAI,CAAC,MAAM,EAAE,UAAU,CAAC,CACxB,IAAI,CAAC,OAAO,EAAE,UAAA,CAAC;eAAI,CAAC,CAAC,IAAI;OAAA,CAAC,CAC1B,EAAE,CAAC,QAAQ,EAAE,YAAW;AACvB,sBAAc,CAAC,IAAI,CAAC,KAAK,EAAE,IAAI,CAAC,OAAO,CAAC,CAAC;OAC1C,CAAC,CAAC;;AAEL,WAAK,CAAC,MAAM,CAAC,MAAM,CAAC,CACjB,IAAI,CAAC,UAAA,CAAC;eAAI,CAAC,CAAC,IAAI;OAAA,CAAC,CAAC;;AAGrB,UAAI,IAAI,GAAG,gBAAG,MAAM,CAAC,mBAAmB,CAAC,CAAC;AAC1C,sBAAG,MAAM,CAAC,YAAY,CAAC,CAAC,MAAM,CAAC,SAAS,CAAC,CAAC,EAAE,CAAC,OAAO,EAAE,YAAW;AAC/D,YAAI,IAAI,CAAC,OAAO,CAAC,SAAS,CAAC,EAAE;AAC3B,cAAI,CAAC,OAAO,CAAC,SAAS,EAAE,KAAK,CAAC,CAAC,KAAK,CAAC,SAAS,EAAE,MAAM,CAAC,CAAC;SACzD,MAAM;AACL,cAAI,CAAC,OAAO,CAAC,SAAS,EAAE,IAAI,CAAC,CAAC,KAAK,CAAC,SAAS,EAAE,OAAO,CAAC,CAAC;SACzD;OACF,CAAC,CAAC;;AAEH,UAAI,CAAC,EAAE,CAAC,MAAM,EAAE,YAAW;AACzB,YAAI,CAAC,OAAO,CAAC,SAAS,EAAE,KAAK,CAAC,CAAC,KAAK,CAAC,SAAS,EAAE,MAAM,CAAC,CAAC;OACzD,CAAC,CAAC;;;AAGH,sBAAG,MAAM,CAAC,mBAAmB,CAAC,CAAC,SAAS,CAAC,KAAK,CAAC,CAC5C,IAAI,CAAC,MAAK,SAAS,CAAC,CACpB,KAAK,EAAE,CACP,MAAM,CAAC,KAAK,CAAC,CACb,IAAI,CAAC,IAAI,EAAE,UAAA,CAAC;eAAI,WAAW,GAAC,CAAC,CAAC,IAAI;OAAA,CAAC,CAAC;;AAEvC,eAAS,GAAG,IAAI,GAAG,EAAE,CAAC;;;;;;AACtB,6BAAc,MAAK,SAAS,8HAAE;cAArB,CAAC;;AACR,mBAAS,CAAC,GAAG,CAAC,CAAC,CAAC,IAAI,EAAE;AACpB,gBAAI,EAAG,CAAC,CAAC,IAAI;AACb,iBAAK,EAAE,wBAAO,YAAY,GAAG,CAAC,CAAC,IAAI,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,MAAM,CAAC,gBAAG,KAAK,CAAC,MAAM,EAAE,CAAC,MAAM,CAAC,CAAC,GAAG,EAAE,CAAC,CAAC,CAAC,CAAC;AAC7F,gBAAI,EAAG,EAAE;WACV,CAAC,CAAC;SACJ;;;;;;;;;;;;;;;KACF;;AAED,aAAS,WAAW,GAAG;AACrB,UAAI,CAAC,GAAG,gBAAG,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,MAAK,QAAQ,CAAC;UACnC,CAAC,GAAG,gBAAG,IAAI,CAAC,GAAG,CAAC,MAAM,CAAC,gBAAG,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,MAAK,MAAM,CAAC,EAAE,CAAC,CAAC;UACxD,KAAK,GAAG,gBAAG,IAAI,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC;UAC/B,KAAK,GAAG,gBAAG,IAAI,CAAC,KAAK,EAAE,CACpB,MAAM,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CACd,UAAU,CAAC,CAAC,CAAC,EAAE,IAAI,CAAC,GAAG,CAAC,KAAK,CAAC,MAAM,EAAE,KAAK,CAAC,CAAC,CAAC,CAAC;;AAEtD,UAAI,IAAI,GAAG,KAAK,CAAC,GAAG,CAAC,UAAU,GAAG,EAAE;AAAE,eAAO,EAAC,CAAC,EAAE,GAAG,EAAE,KAAK,EAAE,CAAC,EAAE,KAAK,EAAE,EAAE,EAAC,CAAC;OAAE,CAAC,CAAC;;;;;;AAC/E,8BAAiB,MAAK,MAAM,mIAAE;cAArB,IAAI;;AACX,cAAI,CAAC,GAAG,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;AACzB,cAAI,CAAC,CAAC,CAAC,CAAC,KAAK,EAAE,CAAC;AAChB,cAAI,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;SAC1B;;;;;;;;;;;;;;;;AAED,iBAAW,GAAG,CAAC,EAAC,KAAK,EAAE,MAAM,EAAE,KAAK,EAAE,OAAO,EAAE,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,IAAI,EAAC,CAAC,CAAC;AAC3E,kBAAY,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC;;;;;;;AAE/B,8BAAiB,SAAS,CAAC,IAAI,EAAE,mIAAE;cAA1B,KAAI;AAAwB,yBAAe,CAAC,KAAI,CAAC,CAAC;SAAE;;;;;;;;;;;;;;;;AAE7D,UAAI,KAAK,GAAG,EAAE,CAAC;;;;;;AACf,8BAAc,SAAS,CAAC,MAAM,EAAE;cAAvB,CAAC;AAAwB,eAAK,CAAC,IAAI,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC;SAAA;;;;;;;;;;;;;;;;AACrD,YAAK,KAAK,CAAC,WAAW,EAAC,KAAK,EAAE,MAAK,QAAQ,EAAE,MAAK,MAAM,CAAC,CACtD,IAAI,CAAE,UAAA,IAAI,EAAI;;;;;;AACb,gCAAc,IAAI,mIAAE;gBAAX,CAAC;;AACR,gBAAI,QAAQ,GAAG,SAAS,CAAC,GAAG,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC;AACrC,oBAAQ,CAAC,IAAI,GAAG,IAAI,GAAG,EAAE,CAAC;;;;;;AAC1B,oCAAc,CAAC,CAAC,IAAI,mIAAE;oBAAb,CAAC;;AACR,wBAAQ,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC;eAC5B;;;;;;;;;;;;;;;WACF;;;;;;;;;;;;;;;;AACD,uBAAe,EAAE,CAAC;OACnB,CAAC,SACI,CAAE,UAAA,CAAC,EAAI;AAAE,eAAO,CAAC,KAAK,CAAC,kBAAkB,EAAE,CAAC,CAAC,CAAC;OAAE,CAAC,CAAC;KAC3D;;AAED,aAAS,gBAAgB,GAAG;AAC1B,UAAI,IAAI,GAAI,gBAAG,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,MAAK,QAAQ,CAAC;UACvC,EAAE,GAAM,gBAAG,IAAI,CAAC,GAAG,CAAC,MAAM,CAAC,gBAAG,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,MAAK,MAAM,CAAC,EAAE,CAAC,CAAC;UAC5D,KAAK,GAAG,gBAAG,IAAI,CAAC,GAAG,CAAC,KAAK,CAAC,IAAI,EAAE,EAAE,CAAC;UACnC,KAAK,GAAG,gBAAG,IAAI,CAAC,KAAK,EAAE,CACpB,MAAM,CAAC,CAAC,IAAI,EAAE,EAAE,CAAC,CAAC,CAClB,UAAU,CAAC,CAAC,CAAC,EAAE,IAAI,CAAC,GAAG,CAAC,KAAK,CAAC,MAAM,EAAE,KAAK,CAAC,CAAC,CAAC,CAAC;;AAEtD,UAAI,cAAc,GAAG,EAAE,CAAC;;;;;;;AAExB,8BAAe,UAAS,CAAC,QAAQ,EAAE,mIAAE;cAA7B,GAAG;;AACT,wBAAc,CAAC,IAAI,CAAC;AAChB,iBAAK,EAAG,GAAG,CAAC,OAAO,CAAC,KAAK;AACzB,iBAAK,EAAG,GAAG,CAAC,KAAK;AACjB,gBAAI,EAAI,MAAM;AACd,kBAAM,EAAE,OAAO;AACf,kBAAM,EAAE,SAAS,CAAC,GAAG,CAAC,KAAK,EAAE,KAAK,EAAE,KAAK,CAAC;WAC3C,CACF,CAAC;SACH;;;;;;;;;;;;;;;;;;;;;AAED,8BAAe,UAAS,CAAC,QAAQ,EAAE,mIAAE;cAA7B,GAAG;;AACT,wBAAc,CAAC,IAAI,CAAC;AAChB,iBAAK,EAAG,GAAG,CAAC,OAAO,CAAC,KAAK;AACzB,iBAAK,EAAG,GAAG,CAAC,KAAK;AACjB,gBAAI,EAAI,MAAM;AACd,kBAAM,EAAE,MAAM;AACd,kBAAM,EAAG,SAAS,CAAC,GAAG,CAAC,KAAK,EAAE,KAAK,EAAE,KAAK,CAAC;WAC5C,CACF,CAAC;SACH;;;;;;;;;;;;;;;;;;;;;;;;;AAWD,oBAAc,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC,CAAC,CAAC,CAAC;AACpC,kBAAY,CAAC,IAAI,CAAC,cAAc,CAAC,CAAC;;AAElC,qBAAe,EAAE,CAAC;KACnB;;AAED,aAAS,cAAc,CAAC,IAAI,EAAE,IAAI,EAAE;AAClC,UAAI,IAAI,EAAE;AACR,YAAI,GAAG,GAAG,gBAAG,MAAM,CAAC,mBAAmB,CAAC,CAAC,MAAM,CAAC,KAAK,CAAC,CACnD,IAAI,CAAC,IAAI,EAAE,QAAQ,GAAC,IAAI,CAAC,CAAC;AAC7B,YAAI,CAAC,GAAG,gBAAG,IAAI,CAAC,KAAK,EAAE,CACpB,IAAI,CAAC,gBAAG,IAAI,CAAC,IAAI,EAAE,CAAC,CAAC,CAAC;AACzB,SAAC,CAAC,UAAU,CAAC,gBAAG,IAAI,CAAC,MAAM,CAAC,OAAO,CAAC,CAAC,CAAC;AACtC,SAAC,CAAC,KAAK,CAAC,gBAAG,IAAI,CAAC,IAAI,EAAE,CAAC,CAAC,CAAC;AACzB,YAAI,CAAC,GAAG,wBAAO,GAAG,CAAC,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC;;AAE1C,iBAAS,CAAC,GAAG,CAAC,IAAI,EAAE,CAAC,CAAC,CAAC;AACvB,uBAAe,CAAC,IAAI,CAAC,CAAC;OACvB,MACI;AACH,wBAAG,MAAM,CAAC,mBAAmB,CAAC,CAAC,MAAM,CAAC,SAAS,GAAC,IAAI,CAAC,CAAC,MAAM,EAAE,CAAC;AAC/D,iBAAS,UAAO,CAAC,IAAI,CAAC,CAAC;OACxB;KACF;;AAED,aAAS,eAAe,CAAC,KAAK,EAAE;AAC9B,UAAI,IAAI,GAAG,gBAAG,IAAI,CAAC,IAAI,CAAC,gBAAG,IAAI,CAAC,GAAG,CAAC,MAAM,CAAC,gBAAG,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,MAAK,MAAM,EAAE,SA7LzE,kBAAkB,AA6L0E,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;AACvG,UAAI,EAAE,GAAG,gBAAG,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,MAAK,MAAM,CAAC,CAAC;AACxC,UAAI,KAAK,GAAG,gBAAG,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,IAAI,EAAE,EAAE,CAAC,CAAC;;AAEzC,UAAI,SAAS,GAAG,gBAAG,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,CAAC;AACzC,UAAI,SAAS,GAAG,IAAI,CAAC,WAAW,EAAE,CAAC;;AAEnC,YAAK,KAAK,CAAC,WAAW,EAAE,CAAC,KAAK,CAAC,EAAE,IAAI,EAAE,MAAK,MAAM,CAAC,CAChD,IAAI,CAAC,UAAS,CAAC,EAAE;;;;;;AAChB,gCAAkB,CAAC,mIAAE;gBAAZ,KAAK;;AACZ,gBAAI,QAAQ,GAAG,KAAK,CAAC,GAAG,CAAC,UAAU,CAAC,EAAE;AAAE,qBAAO,EAAC,CAAC,EAAE,CAAC,EAAE,KAAK,EAAE,CAAC,EAAE,KAAK,EAAE,EAAE,EAAC,CAAC;aAAE,CAAC,CAAC;;;;;;;;AAG/E,qCAAgB,KAAK,CAAC,IAAI,wIAAE;oBAApB,IAAI;;AACV,oBAAI,IAAI,CAAC,QAAQ,EAAE;AACjB,sBAAI,CAAC,IAAI,GAAG,UAAU,CAAC,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;AACxC,sBAAI,CAAC,GAAG,gBAAG,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,WAAW,EAAE,GAAG,SAAS,CAAA,GAAE,EAAE,GAAG,SAAS,CAAC;;AAE7F,0BAAQ,CAAC,CAAC,CAAC,CAAC,KAAK,EAAE,CAAC;AACpB,0BAAQ,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;iBAC9B;eACF;;;;;;;;;;;;;;;;AAED,gBAAI,MAAM,GAAG,CACX;AACE,mBAAK,EAAE,UAAU;AACjB,mBAAK,EAAE,KAAK;AACZ,kBAAI,EAAE,MAAM;AACZ,oBAAM,EAAE,OAAO;AACf,yBAAW,EAAE,YAAY;AACzB,oBAAM,EAAE,QAAQ;;;;;;;;AAAA,aAQjB,CAAC,CAAC;AACL,qBAAS,CAAC,GAAG,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;WACxC;;;;;;;;;;;;;;;OACF,CAAC,SACI,CAAC,UAAS,MAAM,EAAE;AACtB,eAAO,CAAC,KAAK,CAAC,SAAS,EAAE,MAAM,CAAC,CAAC;OAClC,CAAC,CAAC;KACN;;AAED,aAAS,eAAe,GAAG;;;;;;;AAEzB,+BAAqB,SAAS,CAAC,MAAM,EAAE,wIAAE;cAAhC,QAAQ;;AACf,cAAI,IAAI,GAAG,EAAE;cAAE,OAAO,GAAG,EAAE,CAAC;;AAE5B,cAAI,KAAK,GAAG,gBAAG,KAAK,CAAC,MAAM,EAAE,CAAC,MAAM,CAAC,CAAC,GAAG,EAAE,CAAC,CAAC,CAAC,CAAE,UAAU,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;AAChF,eAAK,IAAI,CAAC,GAAC,CAAC,EAAE,CAAC,GAAC,EAAE,EAAE,CAAC,EAAE,EAAE;AACvB,gBAAI,CAAC,IAAI,CAAC,EAAC,CAAC,EAAE,GAAG,GAAG,CAAC,GAAC,EAAE,EAAE,KAAK,EAAE,CAAC,EAAE,KAAK,EAAC,EAAE,EAAC,CAAC,CAAC;AAC/C,mBAAO,CAAC,IAAI,CAAC,EAAC,CAAC,EAAE,GAAG,GAAG,CAAC,GAAC,EAAE,EAAE,KAAK,EAAE,CAAC,EAAE,KAAK,EAAE,EAAE,EAAC,CAAC,CAAC;WACpD;;AAED,cAAI,QAAQ,CAAC,IAAI,CAAC,IAAI,GAAG,CAAC,EAAE;;;;;;AAC1B,qCAAa,UAAS,CAAC,MAAM,wIAAE;oBAAvB,CAAC;;AACP,oBAAI,KAAK,GAAG,QAAQ,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC;AACpC,oBAAI,KAAK,IAAI,SAAS,IAAI,KAAK,IAAI,IAAI,EAAE;AACvC,yBAAO,CAAC,GAAG,CAAC,yBAAyB,EAAE,CAAC,CAAC,EAAE,CAAC,CAAC;iBAC9C,MAAM;AACL,sBAAI,KAAK,CAAC,IAAI,GAAG,GAAG,EAAE;AACpB,wBAAI,CAAC,GAAG,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC,CAAC;AAChC,qBAAC,CAAC,KAAK,EAAE,CAAC;AACV,qBAAC,CAAC,KAAK,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;mBACrB;;AAED,sBAAI,KAAK,CAAC,OAAO,GAAG,GAAG,EAAE;AACvB,wBAAI,CAAC,GAAG,OAAO,CAAC,KAAK,CAAC,KAAK,CAAC,OAAO,CAAC,CAAC,CAAC;AACtC,qBAAC,CAAC,KAAK,EAAE,CAAC;AACV,qBAAC,CAAC,KAAK,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;mBACrB;iBACF;eAEF;;;;;;;;;;;;;;;WACF;;;AAGD,cAAI,CAAC,CAAC,CAAC,CAAC,KAAK,GAAG,CAAC,CAAC;AAClB,iBAAO,CAAC,CAAC,CAAC,CAAC,KAAK,GAAG,CAAC,CAAC;;AAErB,cAAI,MAAM,GAAG,CAAC;AACZ,iBAAK,EAAE,MAAM;AACb,iBAAK,EAAE,KAAK;AACZ,gBAAI,EAAE,MAAM;AACZ,kBAAM,EAAE,OAAO;AACf,uBAAW,EAAE,YAAY;AACzB,kBAAM,EAAE,IAAI;WACb,EACC;AACE,iBAAK,EAAE,SAAS;AAChB,iBAAK,EAAE,MAAM;AACb,gBAAI,EAAE,MAAM;AACZ,kBAAM,EAAE,OAAO;AACf,uBAAW,EAAE,YAAY;AACzB,kBAAM,EAAE,OAAO;WAChB,CAAC,CAAC;AACL,kBAAQ,CAAC,KAAK,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;SAC7B;;;;;;;;;;;;;;;KACF;;AAED,aAAS,OAAO,CAAC,IAAI,EAAE;AACrB,UAAI,CAAC,GAAG,EAAE,CAAC;;;;;;AACX,+BAAkB,IAAI,wIAAE;cAAf,KAAK;;AACZ,WAAC,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;SACf;;;;;;;;;;;;;;;;AACD,aAAO,CAAC,CAAC;KACV;AACD,aAAS,SAAS,CAAC,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE;AACtC,UAAI,IAAI,GAAG,KAAK,CAAC,GAAG,CAAC,UAAU,CAAC,EAAE;AAAE,eAAO,EAAC,CAAC,EAAE,CAAC,EAAE,KAAK,EAAE,CAAC,EAAE,KAAK,EAAE,EAAE,EAAC,CAAC;OAAE,CAAC,CAAC;;;;;;AAC3E,+BAAiB,KAAK,wIAAE;cAAf,IAAI;;AACX,cAAI,CAAC,GAAG,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;AACzB,cAAI,CAAC,CAAC,CAAC,CAAC,KAAK,EAAE,CAAC;AAChB,cAAI,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;SAC1B;;;;;;;;;;;;;;;;AACD,aAAO,IAAI,CAAC;KACb;;AAED,WAAO;AACL,UAAI,EAAA,gBAAG;AACL,aAAI,EAAE,CAAC;AACP,eAAO,IAAI,CAAC;OACb;;AAED,eAAS,EAAA,mBAAC,CAAC,EAAE;AACX,kBAAS,GAAG,CAAC,CAAC;AACd,kBAAS,CAAC,EAAE,CAAC,qBAAqB,EAAE,gBAAgB,CAAC,CAAC;AACtD,eAAO,IAAI,CAAC;OACb;;AAED,YAAM,EAAA,kBAAG;AACP,YAAI,IAAI,YAAA;YAAE,CAAC,YAAA,CAAC;;;;;;AACZ,iCAAiB,MAAM,wIAAE;;;AAApB,gBAAI;AAAE,aAAC;;AACV,gBAAI,CAAC,GAAG,QAAQ,CAAC,gBAAG,MAAM,CAAC,IAAI,CAAC,CAAC,KAAK,CAAC,OAAO,CAAC,CAAC,CAAC;AACjD,gBAAI,EAAC,GAAG,QAAQ,CAAC,gBAAG,MAAM,CAAC,IAAI,CAAC,CAAC,KAAK,CAAC,QAAQ,CAAC,CAAC,CAAC;AAClD,aAAC,CAAC,MAAM,CAAC,CAAC,CAAC,EAAE,EAAC,CAAC,CAAC,CAAC;WAClB;;;;;;;;;;;;;;;;;;;;;AAED,iCAAiB,SAAS,wIAAE;;;AAAvB,gBAAI;AAAE,aAAC;;AACV,gBAAI,CAAC,GAAG,QAAQ,CAAC,gBAAG,MAAM,CAAC,SAAS,GAAG,IAAI,CAAC,CAAC,KAAK,CAAC,OAAO,CAAC,CAAC,CAAC;AAC7D,gBAAI,GAAC,GAAG,QAAQ,CAAC,gBAAG,MAAM,CAAC,SAAS,GAAG,IAAI,CAAC,CAAC,KAAK,CAAC,QAAQ,CAAC,CAAC,CAAC;AAC9D,aAAC,CAAC,MAAM,CAAC,CAAC,CAAC,EAAE,GAAC,CAAC,CAAC,CAAC;WAClB;;;;;;;;;;;;;;;;AAED,YAAI,CAAC,GAAG,QAAQ,CAAC,gBAAG,MAAM,CAAC,YAAY,CAAC,CAAC,KAAK,CAAC,QAAQ,CAAC,CAAC,GAAG,QAAQ,CAAC,gBAAG,MAAM,CAAC,YAAY,CAAC,CAAC,KAAK,CAAC,QAAQ,CAAC,CAAC,CAAC;AAC9G,wBAAG,MAAM,CAAC,mBAAmB,CAAC,CAAC,KAAK,CAAC,YAAY,EAAE,CAAC,GAAG,IAAI,CAAC,CAAC;AAC7D,eAAO,IAAI,CAAC;OACb;KACF,CAAA;GACF","file":"info-charts.js","sourcesContent":["/**\n * Created by yarden on 8/6/15.\n */\n\nimport d3 from 'd3';\nimport postal from 'postal';\n\nimport {pathogens_duration} from '../config'\nimport * as data from '../data'\nimport chart from '../components/chart'\nimport chart3 from '../components/chart3'\n\n\nexport default function(opt) {\n  const MIN_Y = 5;\n  const CHART_MAX_WIDTH = 500;\n\n  let dateFormat = d3.time.format('%Y-%m-%d');\n\n  let selection;\n  let summaryData = [];\n  let summaryChart = chart3('#summary-chart', true);\n  //let selectedChart = chart().el('#selected-chart');\n\n  let pathogensTimeFormat = d3.time.format.multi([\n    [\"%b %d\", function(d) { return d.getDate() != 1; }],\n    [\"%B\", function(d) { return d.getMonth(); }],\n  ]);\n\n  let pathogens_scale = d3.time.scale()\n    .nice(d3.time.week, 1);\n  pathogens_scale.tickFormat(d3.format('%b %d'));\n  pathogens_scale.ticks(d3.time.week, 1);\n\n  let charts = new Map([\n    ['#summary-chart', summaryChart],\n    //['#selected-chart', selectedChart],\n  ]);\n\n  let pathogens = new Map();\n\n  let detectors = [];\n\n  function init() {\n    postal.subscribe({channel: 'data', topic: 'changed', callback: dataChanged});\n\n    /* pathogens */\n    let items = d3.select('#pathogens').select(\"ul\").selectAll('li')\n      .data(data.pathogens)\n      .enter()\n      .append('li');\n\n    items.append('input')\n      .attr('type', 'checkbox')\n      .attr('value', d => d.name)\n      .on(\"change\", function() {\n        selectPathogen(this.value, this.checked);\n      });\n\n    items.append('span')\n      .text(d => d.name);\n\n\n    let menu = d3.select('#pathogens .items');\n    d3.select('#pathogens').select('.anchor').on('click', function() {\n      if (menu.classed('visible')) {\n        menu.classed('visible', false).style('display', 'none');\n      } else {\n        menu.classed('visible', true).style('display', 'block');\n      }\n    });\n\n    menu.on('blur', function() {\n      menu.classed('visible', false).style('display', 'none');\n    });\n\n    /* detectors */\n    d3.select('#detectors-charts').selectAll('div')\n      .data(data.detectors)\n      .enter()\n      .append('div')\n      .attr('id', d => 'detector-'+d.name);\n\n    detectors = new Map();\n    for (let d of data.detectors) {\n      detectors.set(d.name, {\n        name:  d.name,\n        chart: chart3('#detector-' + d.name).title(d.name).xscale(d3.scale.linear().domain([0.5, 1])),\n        data:  []\n      });\n    }\n  }\n\n  function dataChanged() {\n    let f = d3.time.day.ceil(data.fromDate),\n        t = d3.time.day.offset(d3.time.day.ceil(data.toDate), 1),\n        range = d3.time.day.range(f, t),\n        scale = d3.time.scale()\n          .domain([f, t])\n          .rangeRound([0, Math.max(range.length, MIN_Y)]);  // hack: rangeRound still give fraction if range is 0-1\n\n    let bins = range.map(function (day) { return {x: day, value: 0, items: []}; });\n    for (let item of data.domain) {\n      let i = scale(item.date);\n      bins[i].value++;\n      bins[i].items.push(item);\n    }\n\n    summaryData = [{label: 'data', color: 'black', values: bins, right: true}];\n    summaryChart.data(summaryData);\n\n    for (let name of pathogens.keys()) { updatePathogens(name); }\n\n    let names = [];\n    for (let d of detectors.values()) names.push(d.name);\n    data.fetch('detectors',names, data.fromDate, data.toDate)\n      .then( list => {\n        for (let d of list) {\n          let detector = detectors.get(d.name);\n          detector.data = new Map();\n          for (let r of d.rows) {\n            detector.data.set(r.id, r);\n          }\n        }\n        updateDetectors();\n      })\n      .catch( e => { console.error('Detectors error:', e); });\n  }\n\n  function selectionChanged() {\n    let from  = d3.time.day.ceil(data.fromDate),\n        to    = d3.time.day.offset(d3.time.day.ceil(data.toDate), 1),\n        range = d3.time.day.range(from, to),\n        scale = d3.time.scale()\n          .domain([from, to])\n          .rangeRound([0, Math.max(range.length, MIN_Y)]);  // hack: rangeRound still give fraction if range is 0-1\n\n    let selectedSeries = [];\n\n    for(let tag of selection.selected()) {\n      selectedSeries.push({\n          label:  tag.concept.label,\n          color:  tag.color,\n          type:   'line',\n          marker: 'solid',\n          values: histogram(tag.items, range, scale)\n        }\n      );\n    }\n\n    for(let tag of selection.excluded()) {\n      selectedSeries.push({\n          label:  tag.concept.label,\n          color:  tag.color,\n          type:   'line',\n          marker: 'dash',\n          values:  histogram(tag.items, range, scale)\n        }\n      );\n    }\n\n    //selectedSeries.push({\n    //  label: tag.concept.label,\n    //  color: tag.color,\n    //  type: 'line',\n    //  values: histogram(selection.selectedItems(), range)\n    //});\n\n    //selectedChart.data(selectedSeries);\n\n    selectedSeries.push(summaryData[0]);\n    summaryChart.data(selectedSeries);\n\n    updateDetectors();\n  }\n\n  function selectPathogen(name, show) {\n    if (show) {\n      let div = d3.select('#pathogens-charts').append('div')\n        .attr('id', 'chart-'+name);\n      let x = d3.time.scale()\n        .nice(d3.time.week, 1);\n      x.tickFormat(d3.time.format('%m %d'));\n      x.ticks(d3.time.week, 1);\n      let c = chart3(div).title(name).xscale(x);\n\n      pathogens.set(name, c);\n      updatePathogens(name);\n    }\n    else {\n      d3.select('#pathogens-charts').select('#chart-'+name).remove();\n      pathogens.delete(name);\n    }\n  }\n\n  function updatePathogens(names) {\n    let from = d3.time.week(d3.time.day.offset(d3.time.month.offset(data.toDate, -pathogens_duration), 1));\n    let to = d3.time.week.ceil(data.toDate);\n    let range = d3.time.week.range(from, to);\n\n    let from_week = d3.time.weekOfYear(from);\n    let from_year = from.getFullYear();\n\n    data.fetch('pathogens', [names], from, data.toDate)\n      .then(function(d) {\n        for (let entry of d) {\n          let positive = range.map(function (d) { return {x: d, value: 0, items: []}; });\n          //let negative = range.map(function (d) { return {x: d, value: 0, items: []}; });\n\n          for(let item of entry.rows) {\n            if (item.positive) {\n              item.date = dateFormat.parse(item.date);\n              let i = d3.time.weekOfYear(item.date) + (item.date.getFullYear() - from_year)*52 - from_week;\n              //let bins = item.positive ? positive : negative;\n              positive[i].value++;\n              positive[i].items.push(item);\n            }\n          }\n\n          let series = [\n            {\n              label: 'positive',\n              color: 'red',\n              type: 'line',\n              marker: 'solid',\n              interpolate: 'step-after',\n              values: positive\n              //}\n              //{\n              //  label: 'negative',\n              //  color: 'green',\n              //  type: 'line',\n              //  marker: 'solid',\n              //  values: negative\n            }];\n          pathogens.get(entry.name).data(series);\n        }\n      })\n      .catch(function(reason) {\n        console.error('error: ', reason);\n      });\n  }\n\n  function updateDetectors() {\n\n    for (let detector of detectors.values()) {\n      let prob = [], similar = [];\n\n      let scale = d3.scale.linear().domain([0.5, 1]). rangeRound([0, 19]).clamp(true); // .ticks(5);\n      for (let j=0; j<20; j++) {\n        prob.push({x: 0.5 + j/40, value: 0, items:[]});\n        similar.push({x: 0.5 + j/40, value: 0, items: []});\n      }\n\n      if (detector.data.size > 0) {\n        for(let e of selection.domain) {\n          let entry = detector.data.get(e.id);\n          if (entry == undefined || entry == null) {\n            console.log('[Detector] missing prob', e.id);\n          } else {\n            if (entry.prob > 0.5) {\n              let p = prob[scale(entry.prob)];\n              p.value++;\n              p.items.push(entry);\n            }\n\n            if (entry.similar > 0.5) {\n              let s = similar[scale(entry.similar)];\n              s.value++;\n              s.items.push(entry);\n            }\n          }\n\n        }\n      }\n\n      // ignore zero probabilities\n      prob[0].value = 0;\n      similar[0].value = 0;\n\n      let series = [{\n        label: 'prob',\n        color: 'red',\n        type: 'line',\n        marker: 'solid',\n        interpolate: 'step-after',\n        values: prob\n      },\n        {\n          label: 'similar',\n          color: 'gray',\n          type: 'line',\n          marker: 'solid',\n          interpolate: 'step-after',\n          values: similar\n        }];\n      detector.chart.data(series);\n    }\n  }\n\n  function toArray(iter) {\n    let a = [];\n    for (let entry of iter) {\n      a.push(entry);\n    }\n    return a;\n  }\n  function histogram(items, range, scale) {\n    let bins = range.map(function (d) { return {x: d, value: 0, items: []}; });\n    for (let item of items) {\n      let i = scale(item.date);\n      bins[i].value++;\n      bins[i].items.push(item);\n    }\n    return bins;\n  }\n\n  return {\n    init() {\n      init();\n      return this;\n    },\n\n    selection(s) {\n      selection = s;\n      selection.on('changed.info.charts', selectionChanged);\n      return this;\n    },\n\n    resize() {\n      let name, c;\n      for([name, c] of charts) {\n        let w = parseInt(d3.select(name).style('width'));\n        let h = parseInt(d3.select(name).style('height'));\n        c.resize([w, h]);\n      }\n\n      for([name, c] of pathogens) {\n        let w = parseInt(d3.select('#chart-' + name).style('width'));\n        let h = parseInt(d3.select('#chart-' + name).style('height'));\n        c.resize([w, h]);\n      }\n\n      let h = parseInt(d3.select('#info-area').style('height')) - parseInt(d3.select('#pathogens').style('height'));\n      d3.select('#pathogens-charts').style('max-height', h + 'px');\n      return this;\n    }\n  }\n}"]}