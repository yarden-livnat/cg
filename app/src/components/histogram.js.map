{"version":3,"sources":["histogram.es6"],"names":[],"mappings":"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","file":"histogram.js","sourcesContent":["/**\n * Created by yarden on 8/12/15.\n */\n\nimport d3 from 'd3'\n\nexport default function() {\n\n  let\n    margin = {top: 20, right:10, bottom: 10, left: 20},\n    width = 200-margin.left-margin.right,\n    height = 100 - margin.top - margin.bottom,\n    dx = 5, duration = 500,\n    svg, data, _series, handle,\n    dispatch = d3.dispatch('brushed');\n\n  let x = d3.scale.linear()\n    .domain([0, 1])\n    .range([0, width]);\n\n  let y = d3.scale.linear()\n    .domain([0, 1])\n    .rangeRound([height, 0]);\n\n  let xAxis = d3.svg.axis()\n    .scale(x)\n    .orient(\"bottom\")\n    .ticks(5);\n\n  let yAxis = d3.svg.axis()\n    .scale(y)\n    .orient(\"left\")\n    .ticks(4);\n\n  let brush = d3.svg.brush()\n    .x(x)\n    .on('brush', brushed);\n\n  function brushed() {\n    let e = brush.extent();\n    dispatch.brushed(e[0], e[1]);\n  }\n\n  function draw() {\n    if (svg == undefined) return;\n\n    svg.select('.x')\n      .call(xAxis);\n\n    svg.select('.y')\n      .call(yAxis);\n\n    let bar = svg.selectAll('.bar')\n      .data(data, function (d, i) { return d.x; });\n\n    let enter = bar.enter()\n      .append('rect')\n      .attr('class', 'bar')\n      .attr('y', height)\n      .attr('height', 0);\n\n    bar\n      .attr('x', function (d) { return x(d.x); })\n      .attr('width', dx)\n      .transition()\n        .duration(duration)\n        .attr('y', function (d) { return y(d.y); })\n        .attr('height', function (d) { return height - y(d.y); });\n\n    bar.exit()\n      .remove();\n  }\n\n  function histogram(selection) {\n    svg = selection.append('g')\n      .attr('class', 'histogram')\n      .attr('transform', 'translate(' + margin.left + ',' + margin.top + ')');\n\n    svg.append('g')\n      .append('rect')\n      .attr('width', width)\n      .attr('height', height)\n      .style('fill', 'steelblue')\n      .style('opacity', 0.0);\n\n    handle = svg.append('g')\n      .attr('class', 'brush')\n      .call(brush);\n\n    handle.selectAll('rect')\n      .attr('height', height);\n\n    svg.append('g')\n      .attr('class', 'x axis')\n      .attr('transform', 'translate(0,' + height + ')')\n      .call(xAxis);\n\n    svg.append('g')\n      .attr('class', 'y axis')\n      .call(yAxis);\n  }\n\n  histogram.width = function(w) {\n    if (!arguments.length) return width + margin.left + margin.right;\n    width = w - margin.left - margin.right;\n    x.range([0, width]);\n\n    draw();\n    return histogram;\n  };\n\n  histogram.height = function(h) {\n    if (!arguments.length) return height + margin.top + margin.bottom;\n    height = h - margin.top - margin.bottom;\n    y.rangeRound([height, 0]);\n    yAxis.ticks( Math.max(2, height/50));\n    if (handle) {\n      handle.selectAll('rect')\n        .attr('height', height);\n    }\n\n    draw();\n    return histogram;\n  };\n\n  histogram.margin = function(m) {\n    if (!arguments.length) return margin;\n    svg.attr('translate', 'transform(' + (m.left - margin.left) + ',' + (m.top - margin.top) + ')');\n    margin = m;\n    return histogram;\n  };\n\n  histogram.data = function(series) {\n    _series = series;\n    data = d3.layout.histogram()\n      .range(x.domain())\n      .bins(x.ticks(20))\n    (series);\n\n    dx = data.length > 0 ? data[0].dx : 5;\n    let min = x.domain()[0];\n    dx = x(min+dx)-1;\n    //console.log('dx:',dx, ' x(dx):', x(dx));\n    y.domain([0, d3.max(data,  function(d) { return d.y;})]);\n\n    draw();\n    return histogram;\n  };\n\n  histogram.xdomain = function(from, to) {\n    x.domain([from,  to]);\n    let save=duration; duration = 0;\n    this.data(_series);\n    duration = save;\n  };\n\n  histogram.on = function(type, listener) {\n    dispatch.on(type, listener);\n    return histogram;\n  };\n\n  return histogram;\n};\n\n"]}