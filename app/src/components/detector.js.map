{"version":3,"sources":["detector.es6"],"names":[],"mappings":"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","file":"detector.js","sourcesContent":["/**\n * Created by yarden on 8/18/15.\n */\n\nimport d3 from 'd3'\n\nexport default function(options) {\n\n  let margin = {top:5, right: 25, bottom: 15, left:5};\n\n  let width = 200 - margin.right - margin.left;\n  let height = 100 - margin.top - margin.bottom;\n\n  let stack = d3.layout.stack()\n    .offset('wiggle')\n    .values( d => d.values );\n\n  let color = ['#ff8c00', '#98abc5'];\n\n  let x = d3.scale.linear()\n    .domain([0.5, 1])\n    .range([0, width]);\n\n  let y = d3.scale.linear()\n    .range([height, 0]);\n\n  let xAxis = d3.svg.axis()\n      .scale(x)\n      .orient('bottom')\n      .ticks(5);\n\n  let yAxis = d3.svg.axis()\n      .scale(y)\n      .orient('left')\n      .ticks(3);\n\n\n  let detector = function(selection) {\n    selection.each( function(d) {\n      let num = d.data.length;\n      let max = d3.max(d.data, v => v.p + v.s);\n      y.domain([0, max]);\n\n      let svg = d3.select(this).select('g');\n\n      svg.select('x.axis').call(xAxis);\n      svg.select('y.axis').call(yAxis);\n\n      let columns = svg.selectAll('.col')\n        .data(d.data)\n        .enter().append('g')\n          .attr('class', 'col')\n          .attr('transform', d => 'translate(' + x(d.x) + '0)');\n\n      let bars = columns.selectAll('rect')\n        .data(d => [{y0: 0, y1: d.p}, {y0: d.p, y1: d.p + d.s}]);\n\n      bars.enter()\n        .append('rect')\n        .attr('class', 'bar')\n        //.attr('x', d => x(d.x))\n        .attr('y', d => d.y1)\n        .attr('width', width/num)\n        .attr('height', d => y(d.y0) - y(d.y1))\n        .attr('fill', (d, i) => color[i]);\n\n      bars.transition()\n        .attr('y', d => y(d.y0+ d.y))\n        .attr('y', d => d.y1)\n        .attr('height', d => y(d.y0) - y(d.y1));\n    });\n  };\n\n  detector.build = function(selection) {\n    width= parseInt(selection.style('width')) - margin.left - margin.right;\n    height = parseInt(selection.style('height')) - margin.top - margin.bottom;\n\n    let g = selection\n      .append('svg')\n        .attr('width', width + margin.left + margin.right)\n        .attr('height', height + margin.top + margin.bottom)\n        .append('g')\n          .attr('transform', 'translate(' + margin.left + ',' + margin.top+ ')');\n\n    g.append('text')\n        .attr('class', 'title')\n        .attr('x', 5)\n        .attr('y', 5)\n        .text(d => d.name);\n\n    g.append('g')\n      .attr('class', 'x axis')\n      .attr('transform', 'translate(0,' + height + ')')\n      .call(xAxis)\n      .append('text')\n      .attr('dy', '0.7em')\n      .attr('text-anchor', 'end')\n      .text('probability');\n\n    g.append('g')\n      .attr('class', 'y axis')\n      .call(yAxis);\n\n    return this;\n  };\n\n  detector.width = function(w) {\n    if (!arguments.length) return width + margin.left + margin.right;\n    width = w - margin.left - margin.right;\n    x.range([0, width]);\n    return this;\n  };\n\n  detector.height = function(h) {\n    if (!arguments.length) return height + margin.top + margin.bottom;\n    height = h - margin.top - margin.bottom;\n    y.range([height, 0]);\n    return this;\n  };\n\n  return detector;\n}"]}