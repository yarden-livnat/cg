{"version":3,"sources":["Selector.es6"],"names":[],"mappings":"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","file":"Selector.js","sourcesContent":["/**\n * Created by yarden on 8/13/15.\n */\n\nimport d3 from 'd3'\n\nexport default function() {\n\n  let\n    margin = {top: 5, right:5, bottom: 10, left: 5},\n    width = 100-margin.left-margin.right,\n    height = 50 - margin.top - margin.bottom,\n    dx = 5, duration = 500,\n    svg, data, _series, handle,\n    dispatch = d3.dispatch('select');\n\n  let x = d3.scale.linear()\n    .domain([-1, 1])\n    .range([0, width]);\n\n  let y = d3.scale.linear()\n    .domain([0, 1])\n    .rangeRound([height, 0]);\n\n  let xAxis = d3.svg.axis()\n    .scale(x)\n    .orient(\"bottom\")\n    .ticks(0);\n\n  let brush = d3.svg.brush()\n    .x(x)\n    .extent([0, 1])\n    .on('brush', brushed);\n\n  function brushed() {\n    dispatch.select(brush.extent());\n  }\n\n  function draw() {\n    if (svg == undefined) return;\n\n    svg.select('.x')\n      .call(xAxis);\n\n    let bar = svg.select('#bars').selectAll('.bar')\n      .data(data, function (d, i) { return d.x; });\n\n    let enter = bar.enter().append('rect')\n      .attr('class', 'bar')\n      .attr('y', height)\n      .attr('height', 0);\n\n    bar\n      .attr('x', function (d) { return x(d.x); })\n      .attr('width', dx)\n      .transition()\n      .duration(duration)\n      .attr('y', function (d) { return y(d.y); })\n      .attr('height', function (d) { return height - y(d.y); });\n\n    bar.exit()\n      .remove();\n  }\n\n  function selector(selection) {\n    svg = selection.append('g')\n      .attr('class', 'selector')\n      .attr('transform', 'translate(' + margin.left + ',' + margin.top + ')');\n\n    svg.append('g')\n      .attr('id', 'bars');\n\n    svg.append('g')\n      .append('rect')\n      .attr('width', width)\n      .attr('height', height)\n      .style('fill', 'steelblue')\n      .style('opacity', 0.0);\n\n    handle = svg.append('g')\n      .attr('class', 'brush')\n      .call(brush);\n\n    handle.selectAll('rect')\n      .attr('height', height);\n\n    svg.append('g')\n      .attr('class', 'x axis')\n      .attr('transform', 'translate(0,' + height + ')')\n      .call(xAxis);\n  }\n\n  selector.width = function(w) {\n    if (!arguments.length) return width + margin.left + margin.right;\n    width = w - margin.left - margin.right;\n    x.range([0, width]);\n\n    draw();\n    return selector;\n  };\n\n  selector.height = function(h) {\n    if (!arguments.length) return height + margin.top + margin.bottom;\n    height = h - margin.top - margin.bottom;\n    y.rangeRound([height, 0]);\n    //yAxis.ticks( Math.max(2, height/50));\n    if (handle) {\n      handle.selectAll('rect')\n        .attr('height', height);\n    }\n\n    draw();\n    return selector;\n  };\n\n  selector.margin = function(m) {\n    if (!arguments.length) return margin;\n    svg.attr('translate', 'transform(' + (m.left - margin.left) + ',' + (m.top - margin.top) + ')');\n    margin = m;\n    return selector;\n  };\n\n  selector.data = function(series) {\n    _series = series;\n    data = d3.layout.histogram()\n      .range(x.domain())\n      .bins(x.ticks(20))\n    (series);\n\n    dx = data.length > 0 ? data[0].dx : 5;\n    let min = x.domain()[0];\n    dx = x(min+dx)-1;\n    y.domain([0, d3.max(data,  function(d) { return d.y;})]);\n\n    draw();\n    return selector;\n  };\n\n  selector.select = function(r) {\n    brush.extent(r);\n    return this;\n  };\n\n  selector.xdomain = function(from, to) {\n    x.domain([from,  to]);\n    let save=duration;\n    duration = 0;\n    this.data(_series);\n    duration = save;\n  };\n\n  selector.on = function(type, listener) {\n    dispatch.on(type, listener);\n    return selector;\n  };\n\n  return selector;\n};\n\n"]}