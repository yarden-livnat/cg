{"version":3,"sources":["tag_selection.es6"],"names":[],"mappings":";;;;;;;;;;UAqBgB,MAAM,GAAN,MAAM;UAMN,OAAO,GAAP,OAAO;UAMP,OAAO,GAAP,OAAO;UAIP,UAAU,GAAV,UAAU;UAIV,UAAU,GAAV,UAAU;UAIV,MAAM,GAAN,MAAM;;;;;;AArCtB,MAAI,SAAS,GAAG,UAAS,QAAQ,CAAC;AAClC,MAAI,QAAQ,GAAG,IAAI,GAAG,EAAE,CAAC;AACzB,MAAI,QAAQ,GAAG,IAAI,GAAG,EAAE,CAAC;;AAGzB,WAAS,MAAM,GAAG;AAChB,QAAI,OAAO,EAAE,EACX,SAAS,CAAC,SAAS,EAAE,CAAC,KAEtB,SAAS,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC;AAC3B,cAAS,MAAM,CAAC,SAAS,CAAC,CAAC;AAC3B,wBAAO,OAAO,CAAC,EAAC,OAAO,EAAE,QAAQ,EAAE,KAAK,EAAE,QAAQ,EAAC,CAAC,CAAC;GACtD;;AACM,WAAS,MAAM,CAAC,IAAI,EAAE;AAC3B,QAAI,CAAC,QAAQ,UAAO,CAAC,IAAI,CAAC,EAAE,QAAQ,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC;AAC/C,YAAQ,UAAO,CAAC,IAAI,CAAC,CAAC;AACtB,UAAM,EAAE,CAAC;GACV;;AAEM,WAAS,OAAO,CAAC,IAAI,EAAE;AAC5B,QAAI,CAAC,QAAQ,UAAO,CAAC,IAAI,CAAC,EAAE,QAAQ,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC;AAC/C,YAAQ,UAAO,CAAC,IAAI,CAAC,CAAC;AACtB,UAAM,EAAE,CAAC;GACV;;AAEM,WAAS,OAAO,GAAG;AACxB,WAAO,QAAQ,CAAC,IAAI,IAAI,CAAC,IAAI,QAAQ,CAAC,IAAI,IAAI,CAAC,CAAC;GACjD;;AAEM,WAAS,UAAU,CAAC,IAAI,EAAE;AAC/B,WAAO,QAAQ,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC;GAC3B;;AAEM,WAAS,UAAU,CAAC,IAAI,EAAE;AAC/B,WAAO,QAAQ,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC;GAC3B;;AAEM,WAAS,MAAM,CAAC,GAAG,EAAE;AAC1B,QAAI,GAAG,GAAG,UAAS,aAAa,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC;;;;;;AAC1C,2BAAc,QAAQ;YAAb,CAAC;AAAc,YAAI,CAAC,GAAG,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,CAAC,EAAE,OAAO,KAAK,CAAC;OAAA;;;;;;;;;;;;;;;;;;;;;AAC3D,4BAAc,QAAQ;YAAb,CAAC;AAAc,YAAI,GAAG,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,CAAC,EAAE,OAAO,KAAK,CAAC;OAAA;;;;;;;;;;;;;;;;AAC1D,WAAO,IAAI,CAAC;GACb","file":"tag_selection.js","sourcesContent":["/**\n * Created by yarden on 10/27/15.\n */\n\nimport * as patients from './patients';\nimport postal from 'postal';\n\n\nlet dimension = patients.enc_tags;\nlet selected = new Set();\nlet excluded = new Set();\n\n\nfunction update() {\n  if (isEmpty())\n    dimension.filterAll();\n  else\n    dimension.filter(filter);\n  patients.update(dimension);\n  postal.publish({channel: 'global', topic: 'render'});\n}\nexport function select(item) {\n  if (!selected.delete(item)) selected.add(item);\n  excluded.delete(item);\n  update();\n}\n\nexport function exclude(item) {\n  if (!excluded.delete(item)) excluded.add(item);\n  selected.delete(item);\n  update();\n}\n\nexport function isEmpty() {\n  return selected.size == 0 && excluded.size == 0;\n}\n\nexport function isSelected(item) {\n  return selected.has(item);\n}\n\nexport function isExcluded(item) {\n  return excluded.has(item);\n}\n\nexport function filter(eid) {\n  let enc = patients.encountersMap.get(eid);\n  for (let s of selected) if (!enc.tags.has(s)) return false;\n  for (let e of excluded) if (enc.tags.has(e)) return false;\n  return true;\n}\n\n"]}